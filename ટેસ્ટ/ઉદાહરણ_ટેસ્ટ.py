#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
ркЙркжрк╛рк╣рк░ркг ркЯрлЗрк╕рлНркЯ - ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркИркерки

ркЖ рклрк╛ркИрк▓ ркмркзрк╛ ркЙркжрк╛рк╣рк░ркгрлЛркирлБркВ ркЯрлЗрк╕рлНркЯрк┐ркВркЧ ркХрк░рлЗ ркЫрлЗ ркЕркирлЗ ркдрлЗркоркирлА ркХрк╛рк░рлНркпркХрлНрк╖ркоркдрк╛ ркЪркХрк╛рк╕рлЗ ркЫрлЗ.
"""

import os
import sys
import unittest
import tempfile
import subprocess
from pathlib import Path

# рккрлНрк░рлЛркЬрлЗркХрлНркЯ рккрк╛рке ркЙркорлЗрк░рлЛ
sys.path.insert(0, os.path.join(os.path.dirname(__file__), '..'))

from ркЧрлБркЬрк░рк╛ркдрлА_рккрк╛ркИркерки import ркХрлЛркб_ркЕркирлБрк╡рк╛ркж_ркХрк░рлЛ, ркЧрлБркЬрк░рк╛ркдрлА_ркХрлЛркб_ркЪрк▓рк╛рк╡рлЛ


class ркЙркжрк╛рк╣рк░ркг_ркЯрлЗрк╕рлНркЯ(unittest.TestCase):
    """ркмркзрк╛ ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓рлЛркирк╛ ркЯрлЗрк╕рлНркЯ"""

    def setUp(self):
        """ркЯрлЗрк╕рлНркЯ ркорк╛ркЯрлЗ рк╕рлЗркЯркЕркк"""
        self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке = Path(__file__).parent.parent
        self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке = self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке / "ркЙркжрк╛рк╣рк░ркгрлЛ"
        self.ркорлБркЦрлНркп_рклрк╛ркИрк▓ = self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке / "ркорлБркЦрлНркп.py"
        
        # ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ рклрк╛ркИрк▓рлЛ ркЕрк╕рлНркдрк┐ркдрлНрк╡ркорк╛ркВ ркЫрлЗ
        self.assertTrue(self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке.exists(), f"ркЙркжрк╛рк╣рк░ркг ркбрк┐рк░рлЗркХрлНркЯрк░рлА ркорк│рлА ркиркерлА: {self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке}")
        self.assertTrue(self.ркорлБркЦрлНркп_рклрк╛ркИрк▓.exists(), f"ркорлБркЦрлНркп рклрк╛ркИрк▓ ркорк│рлА ркиркерлА: {self.ркорлБркЦрлНркп_рклрк╛ркИрк▓}")

    def _рклрк╛ркИрк▓_ркЪрк▓рк╛рк╡рлЛ(self, ркЙркжрк╛рк╣рк░ркг_ркирк╛рко):
        """
        ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓ ркЪрк▓рк╛рк╡рлЗ ркЫрлЗ ркЕркирлЗ ркдрлЗркирлБркВ рккрк░рк┐ркгрк╛рко рккрк░ркд ркХрк░рлЗ ркЫрлЗ
        
        рккрлЗрк░рк╛ркорлАркЯрк░:
            ркЙркжрк╛рк╣рк░ркг_ркирк╛рко (str): ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓ркирлБркВ ркирк╛рко
            
        рккрк░ркд:
            dict: {'returncode': int, 'stdout': str, 'stderr': str}
        """
        рклрк╛ркИрк▓_рккрк╛рке = self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке / ркЙркжрк╛рк╣рк░ркг_ркирк╛рко
        self.assertTrue(рклрк╛ркИрк▓_рккрк╛рке.exists(), f"ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓ ркорк│рлА ркиркерлА: {рклрк╛ркИрк▓_рккрк╛рке}")
        
        # Python subprocess ркЙрккркпрлЛркЧ ркХрк░рлАркирлЗ рклрк╛ркИрк▓ ркЪрк▓рк╛рк╡рлЛ
        рккрк░рк┐ркгрк╛рко = subprocess.run(
            [sys.executable, str(self.ркорлБркЦрлНркп_рклрк╛ркИрк▓), str(рклрк╛ркИрк▓_рккрк╛рке)],
            capture_output=True,
            text=True,
            encoding='utf-8',
            cwd=str(self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке)
        )
        
        return {
            'returncode': рккрк░рк┐ркгрк╛рко.returncode,
            'stdout': рккрк░рк┐ркгрк╛рко.stdout,
            'stderr': рккрк░рк┐ркгрк╛рко.stderr
        }

    def test_рк╕рк░рк│_ркбрлЗркорлЛ(self):
        """рк╕рк░рк│ ркбрлЗркорлЛ рклрк╛ркИрк▓ркирлБркВ ркЯрлЗрк╕рлНркЯ"""
        рккрк░рк┐ркгрк╛рко = self._рклрк╛ркИрк▓_ркЪрк▓рк╛рк╡рлЛ("рк╕рк░рк│_ркбрлЗркорлЛ.py")
        
        self.assertEqual(рккрк░рк┐ркгрк╛рко['returncode'], 0, 
                        f"рк╕рк░рк│ ркбрлЗркорлЛ fail ркеркпрлЛ. Error: {рккрк░рк┐ркгрк╛рко['stderr']}")
        
        ркЖркЙркЯрккрлБркЯ = рккрк░рк┐ркгрк╛рко['stdout']
        
        # ркорлБркЦрлНркп ркЖркЙркЯрккрлБркЯ ркЪркХрк╛рк╕рлЛ
        self.assertIn("ркиркорк╕рлНркдрлЗ! ркЖ ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркИркерки ркЫрлЗ!", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркорк╛рк░рлБркВ ркирк╛рко рк░рк╛рко ркЫрлЗ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("10 + 20 = 30", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркдркорлЗ рккрлБркЦрлНркд ркЫрлЛ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркИркерки ркбрлЗркорлЛ рккрлВрк░рлНркг!", ркЖркЙркЯрккрлБркЯ)

    def test_ркорлВрк│ркнрлВркд_ркЙркжрк╛рк╣рк░ркг(self):
        """ркорлВрк│ркнрлВркд ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓ркирлБркВ ркЯрлЗрк╕рлНркЯ"""
        рккрк░рк┐ркгрк╛рко = self._рклрк╛ркИрк▓_ркЪрк▓рк╛рк╡рлЛ("ркорлВрк│ркнрлВркд_ркЙркжрк╛рк╣рк░ркг.py")
        
        self.assertEqual(рккрк░рк┐ркгрк╛рко['returncode'], 0, 
                        f"ркорлВрк│ркнрлВркд ркЙркжрк╛рк╣рк░ркг fail ркеркпрлЛ. Error: {рккрк░рк┐ркгрк╛рко['stderr']}")
        
        ркЖркЙркЯрккрлБркЯ = рккрк░рк┐ркгрк╛рко['stdout']
        
        # ркорлБркЦрлНркп ркЖркЙркЯрккрлБркЯ ркЪркХрк╛рк╕рлЛ
        self.assertIn("рк╕рлНрк╡рк╛ркЧркд ркЫрлЗ ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркЗркерки", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркЧркгрк┐ркдркирк╛ ркУрккрк░рлЗрк╢рки", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("рк╢рк░ркд рккрк░рлАркХрлНрк╖ркг", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("рк▓рлВрккрлНрк╕", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркбрлЗркЯрк╛ рк╕рлНркЯрлНрк░ркХрлНркЪрк░", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркПрк░рк░ рк╣рлЗркирлНркбрк▓рк┐ркВркЧ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркЗркеркиркирлЛ ркбрлЗркорлЛ рккрлВрк░рлНркг!", ркЖркЙркЯрккрлБркЯ)

    def test_ркХрлНрк▓рк╛рк╕_ркЙркжрк╛рк╣рк░ркг(self):
        """ркХрлНрк▓рк╛рк╕ ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓ркирлБркВ ркЯрлЗрк╕рлНркЯ"""
        рккрк░рк┐ркгрк╛рко = self._рклрк╛ркИрк▓_ркЪрк▓рк╛рк╡рлЛ("ркХрлНрк▓рк╛рк╕_ркЙркжрк╛рк╣рк░ркг.py")
        
        self.assertEqual(рккрк░рк┐ркгрк╛рко['returncode'], 0, 
                        f"ркХрлНрк▓рк╛рк╕ ркЙркжрк╛рк╣рк░ркг fail ркеркпрлЛ. Error: {рккрк░рк┐ркгрк╛рко['stderr']}")
        
        ркЖркЙркЯрккрлБркЯ = рккрк░рк┐ркгрк╛рко['stdout']
        
        # ркорлБркЦрлНркп ркЖркЙркЯрккрлБркЯ ркЪркХрк╛рк╕рлЛ
        self.assertIn("ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркИркерки - ркХрлНрк▓рк╛рк╕ ркбрлЗркорлЛ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркХрлБрк▓ рк╡рлНркпркХрлНркдрк┐ркУ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("рк╣рлБркВ рк░рк╛ркЬрлЗрк╢ ркЫрлБркВ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("рк╣рлБркВ рккрлНрк░рк┐ркпрк╛ ркЫрлБркВ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("рк╣рк╡рлЗ ркорк┐ркдрлНрк░рлЛ ркЫрлЗ", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("рк░рлАрккрлЛрк░рлНркЯ ркХрк╛рк░рлНркб", ркЖркЙркЯрккрлБркЯ)
        self.assertIn("ркХрлНрк▓рк╛рк╕ ркбрлЗркорлЛ рккрлВрк░рлНркг!", ркЖркЙркЯрккрлБркЯ)

    def test_ркмркзрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ_ркпрк╛ркжрлА(self):
        """ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ ркмркзрк╛ ркЕрккрлЗркХрлНрк╖рк┐ркд ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓рлЛ ркЕрк╕рлНркдрк┐ркдрлНрк╡ркорк╛ркВ ркЫрлЗ"""
        ркЕрккрлЗркХрлНрк╖рк┐ркд_рклрк╛ркИрк▓рлЛ = [
            "рк╕рк░рк│_ркбрлЗркорлЛ.py",
            "ркорлВрк│ркнрлВркд_ркЙркжрк╛рк╣рк░ркг.py", 
            "ркХрлНрк▓рк╛рк╕_ркЙркжрк╛рк╣рк░ркг.py",
            "ркЕркбрк╡рк╛ркирлНрк╕_ркЙркжрк╛рк╣рк░ркг.py",
            "рк╕ркВрккрлВрк░рлНркг_ркЙркжрк╛рк╣рк░ркг.py"
        ]
        
        for рклрк╛ркИрк▓_ркирк╛рко in ркЕрккрлЗркХрлНрк╖рк┐ркд_рклрк╛ркИрк▓рлЛ:
            рклрк╛ркИрк▓_рккрк╛рке = self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке / рклрк╛ркИрк▓_ркирк╛рко
            self.assertTrue(рклрк╛ркИрк▓_рккрк╛рке.exists(), 
                           f"ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓ ркорк│рлА ркиркерлА: {рклрк╛ркИрк▓_ркирк╛рко}")

    def test_ркЙркжрк╛рк╣рк░ркг_рклрк╛ркИрк▓_рк╡рк╛ркЪрки(self):
        """ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ ркЙркжрк╛рк╣рк░ркг рклрк╛ркИрк▓рлЛ UTF-8 ркорк╛ркВ рк╡рк╛ркВркЪрлА рк╢ркХрк╛ркп ркЫрлЗ"""
        ркХрк╛рко_ркХрк░ркдрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ = [
            "рк╕рк░рк│_ркбрлЗркорлЛ.py",
            "ркорлВрк│ркнрлВркд_ркЙркжрк╛рк╣рк░ркг.py", 
            "ркХрлНрк▓рк╛рк╕_ркЙркжрк╛рк╣рк░ркг.py"
        ]
        
        for рклрк╛ркИрк▓_ркирк╛рко in ркХрк╛рко_ркХрк░ркдрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ:
            with self.subTest(рклрк╛ркИрк▓=рклрк╛ркИрк▓_ркирк╛рко):
                рклрк╛ркИрк▓_рккрк╛рке = self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке / рклрк╛ркИрк▓_ркирк╛рко
                
                # рклрк╛ркИрк▓ рк╡рк╛ркВркЪрлЛ
                рк╕рк╛ркоркЧрлНрк░рлА = рклрк╛ркИрк▓_рккрк╛рке.read_text(encoding='utf-8')
                self.assertIsNotNone(рк╕рк╛ркоркЧрлНрк░рлА, f"рклрк╛ркИрк▓ рк╕рк╛ркоркЧрлНрк░рлА null ркЫрлЗ: {рклрк╛ркИрк▓_ркирк╛рко}")
                self.assertGreater(len(рк╕рк╛ркоркЧрлНрк░рлА), 0, f"рклрк╛ркИрк▓ ркЦрк╛рк▓рлА ркЫрлЗ: {рклрк╛ркИрк▓_ркирк╛рко}")
                
                # ркЧрлБркЬрк░рк╛ркдрлА ркпрлБркирк┐ркХрлЛркб ркЕркХрлНрк╖рк░рлЛ ркЫрлЗ ркХрлЗ ркирк╣рлАркВ
                self.assertTrue(any(ord(char) > 127 for char in рк╕рк╛ркоркЧрлНрк░рлА), 
                               f"ркЧрлБркЬрк░рк╛ркдрлА ркЕркХрлНрк╖рк░рлЛ ркорк│рлНркпрк╛ ркиркерлА: {рклрк╛ркИрк▓_ркирк╛рко}")

    def test_ркЕркирлБрк╡рк╛ркж_ркХрлНрк╖ркоркдрк╛(self):
        """ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ ркХрк╛рко ркХрк░ркдрк╛ ркЙркжрк╛рк╣рк░ркгрлЛ рк╕рклрк│ркдрк╛рккрлВрк░рлНрк╡ркХ ркЕркирлБрк╡рк╛ркж ркерк╛ркп ркЫрлЗ"""
        ркХрк╛рко_ркХрк░ркдрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ = [
            "рк╕рк░рк│_ркбрлЗркорлЛ.py",
            "ркорлВрк│ркнрлВркд_ркЙркжрк╛рк╣рк░ркг.py", 
            "ркХрлНрк▓рк╛рк╕_ркЙркжрк╛рк╣рк░ркг.py"
        ]
        
        for рклрк╛ркИрк▓_ркирк╛рко in ркХрк╛рко_ркХрк░ркдрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ:
            with self.subTest(рклрк╛ркИрк▓=рклрк╛ркИрк▓_ркирк╛рко):
                рклрк╛ркИрк▓_рккрк╛рке = self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке / рклрк╛ркИрк▓_ркирк╛рко
                
                # рклрк╛ркИрк▓ рк╡рк╛ркВркЪрлЛ
                ркЧрлБркЬрк░рк╛ркдрлА_ркХрлЛркб = рклрк╛ркИрк▓_рккрк╛рке.read_text(encoding='utf-8')
                
                # ркЕркирлБрк╡рк╛ркж ркХрк░рлЛ
                ркЕркВркЧрлНрк░рлЗркЬрлА_ркХрлЛркб = ркХрлЛркб_ркЕркирлБрк╡рк╛ркж_ркХрк░рлЛ(ркЧрлБркЬрк░рк╛ркдрлА_ркХрлЛркб)
                
                # ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ ркЕркирлБрк╡рк╛ркж ркеркпрлЛ ркЫрлЗ
                self.assertIsNotNone(ркЕркВркЧрлНрк░рлЗркЬрлА_ркХрлЛркб, f"ркЕркирлБрк╡рк╛ркж ркирк╣рлАркВ ркеркпрлЛ: {рклрк╛ркИрк▓_ркирк╛рко}")
                self.assertGreater(len(ркЕркВркЧрлНрк░рлЗркЬрлА_ркХрлЛркб), 0, f"ркЕркирлБрк╡рк╛ркж ркЦрк╛рк▓рлА ркЫрлЗ: {рклрк╛ркИрк▓_ркирк╛рко}")
                
                # ркорлВрк│ркнрлВркд ркХрлАрк╡рк░рлНркб ркЕркирлБрк╡рк╛ркж ркЪркХрк╛рк╕рлЛ
                if "ркЫрк╛рккрлЛ(" in ркЧрлБркЬрк░рк╛ркдрлА_ркХрлЛркб:
                    self.assertIn("print(", ркЕркВркЧрлНрк░рлЗркЬрлА_ркХрлЛркб, f"ркЫрк╛рккрлЛркирлЛ ркЕркирлБрк╡рк╛ркж ркирк╣рлАркВ ркеркпрлЛ: {рклрк╛ркИрк▓_ркирк╛рко}")


class рккрлНрк░ркжрк░рлНрк╢рки_ркЯрлЗрк╕рлНркЯ(unittest.TestCase):
    """ркЙркжрк╛рк╣рк░ркгрлЛ ркорк╛ркЯрлЗ рккрлНрк░ркжрк░рлНрк╢рки ркЯрлЗрк╕рлНркЯ"""

    def setUp(self):
        """ркЯрлЗрк╕рлНркЯ ркорк╛ркЯрлЗ рк╕рлЗркЯркЕркк"""
        self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке = Path(__file__).parent.parent
        self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке = self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке / "ркЙркжрк╛рк╣рк░ркгрлЛ"
        self.ркорлБркЦрлНркп_рклрк╛ркИрк▓ = self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке / "ркорлБркЦрлНркп.py"

    def test_ркЙркжрк╛рк╣рк░ркг_ркПркХрлНркЭрк┐ркХрлНркпрлБрк╢рки_рк╕ркоркп(self):
        """ркЦрк╛ркдрк░рлА ркХрк░рлЛ ркХрлЗ ркЙркжрк╛рк╣рк░ркгрлЛ рк╡рлНркпрк╛ркЬркмрлА рк╕ркоркпркорк╛ркВ ркЪрк╛рк▓рлЗ ркЫрлЗ"""
        import time
        
        ркХрк╛рко_ркХрк░ркдрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ = [
            ("рк╕рк░рк│_ркбрлЗркорлЛ.py", 5.0),  # ркорк╣ркдрлНркдрко 5 рк╕рлЗркХркирлНркб
            ("ркорлВрк│ркнрлВркд_ркЙркжрк╛рк╣рк░ркг.py", 10.0),  # ркорк╣ркдрлНркдрко 10 рк╕рлЗркХркирлНркб
            ("ркХрлНрк▓рк╛рк╕_ркЙркжрк╛рк╣рк░ркг.py", 15.0)  # ркорк╣ркдрлНркдрко 15 рк╕рлЗркХркирлНркб
        ]
        
        for рклрк╛ркИрк▓_ркирк╛рко, ркорк╣ркдрлНркдрко_рк╕ркоркп in ркХрк╛рко_ркХрк░ркдрк╛_ркЙркжрк╛рк╣рк░ркгрлЛ:
            with self.subTest(рклрк╛ркИрк▓=рклрк╛ркИрк▓_ркирк╛рко):
                рклрк╛ркИрк▓_рккрк╛рке = self.ркЙркжрк╛рк╣рк░ркг_рккрк╛рке / рклрк╛ркИрк▓_ркирк╛рко
                
                рк╢рк░рлБркЖркд_рк╕ркоркп = time.time()
                
                рккрк░рк┐ркгрк╛рко = subprocess.run(
                    [sys.executable, str(self.ркорлБркЦрлНркп_рклрк╛ркИрк▓), str(рклрк╛ркИрк▓_рккрк╛рке)],
                    capture_output=True,
                    text=True,
                    encoding='utf-8',
                    cwd=str(self.рккрлНрк░рлЛркЬрлЗркХрлНркЯ_рккрк╛рке),
                    timeout=ркорк╣ркдрлНркдрко_рк╕ркоркп  # Timeout protection
                )
                
                ркЕркВркд_рк╕ркоркп = time.time()
                ркХрлБрк▓_рк╕ркоркп = ркЕркВркд_рк╕ркоркп - рк╢рк░рлБркЖркд_рк╕ркоркп
                
                self.assertEqual(рккрк░рк┐ркгрк╛рко.returncode, 0, 
                               f"{рклрк╛ркИрк▓_ркирк╛рко} execute ркирк╣рлАркВ ркеркпрлЛ")
                self.assertLess(ркХрлБрк▓_рк╕ркоркп, ркорк╣ркдрлНркдрко_рк╕ркоркп, 
                               f"{рклрк╛ркИрк▓_ркирк╛рко} рк╡ркзрлБ рккркбркдрлЛ рк╕ркоркп рк▓рлАркзрлЛ: {ркХрлБрк▓_рк╕ркоркп:.2f}s")


if __name__ == "__main__":
    print("=" * 60)
    print("ЁЯзк ркЧрлБркЬрк░рк╛ркдрлА рккрк╛ркИркерки - ркЙркжрк╛рк╣рк░ркг ркЯрлЗрк╕рлНркЯ")  
    print("=" * 60)
    print()
    
    # UTF-8 ркЖркЙркЯрккрлБркЯ ркорк╛ркЯрлЗ encoding set ркХрк░рлЛ
    if hasattr(sys.stdout, 'reconfigure'):
        sys.stdout.reconfigure(encoding='utf-8')
    if hasattr(sys.stderr, 'reconfigure'):
        sys.stderr.reconfigure(encoding='utf-8')
    
    unittest.main(verbosity=2, buffer=True)